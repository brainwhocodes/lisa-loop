#!/bin/bash
# Skill: run-tests
# Description: Runs canonical test commands for the project
# Usage: source .codex/skills/run-tests

echo "üß™ Running tests..."

# Detect project type and run appropriate tests
if [[ -f "package.json" ]]; then
    # Node.js/JavaScript project
    echo "Detected Node.js project"
    if npm run test:unit 2>/dev/null; then
        echo "‚úÖ Unit tests passed"
    else
        echo "‚ÑπÔ∏è  No test:unit script, running npm test"
        npm test
    fi
elif [[ -f "requirements.txt" ]] || [[ -f "pyproject.toml" ]]; then
    # Python project
    echo "Detected Python project"
    if [[ -f "pytest.ini" ]] || grep -q "pytest" pyproject.toml 2>/dev/null; then
        echo "Running pytest..."
        pytest
    else
        echo "No test framework detected"
    fi
elif [[ -f "Cargo.toml" ]]; then
    # Rust project
    echo "Detected Rust project"
    echo "Running cargo test..."
    cargo test
elif [[ -f "go.mod" ]]; then
    # Go project
    echo "Detected Go project"
    echo "Running go test..."
    go test ./...
else
    echo "‚ö†Ô∏è  No recognized test framework found"
    echo "Supported: Node.js (npm test), Python (pytest), Rust (cargo test), Go (go test)"
    exit 1
fi
